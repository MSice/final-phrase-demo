{"remainingRequest":"/Users/bytedance/code/final-phrase-demo/node_modules/babel-loader/lib/index.js!/Users/bytedance/code/final-phrase-demo/node_modules/ts-loader/index.js??ref--15-2!/Users/bytedance/code/final-phrase-demo/node_modules/eslint-loader/index.js??ref--14-0!/Users/bytedance/code/final-phrase-demo/src/utils/index.ts","dependencies":[{"path":"/Users/bytedance/code/final-phrase-demo/src/utils/index.ts","mtime":1720003919956},{"path":"/Users/bytedance/code/final-phrase-demo/babel.config.js","mtime":1720003914930},{"path":"/Users/bytedance/code/final-phrase-demo/node_modules/cache-loader/dist/cjs.js","mtime":1720003915936},{"path":"/Users/bytedance/code/final-phrase-demo/node_modules/babel-loader/lib/index.js","mtime":1720003915886},{"path":"/Users/bytedance/code/final-phrase-demo/node_modules/ts-loader/index.js","mtime":1720003919451},{"path":"/Users/bytedance/code/final-phrase-demo/node_modules/eslint-loader/index.js","mtime":1720003917683}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:LyoKICogQEF1dGhvcjogNzc3CiAqIEBEYXRlOiAyMDI0LTAzLTI1IDIxOjA4OjMwCiAqIEBMYXN0RWRpdG9yczogNzc3CiAqIEBMYXN0RWRpdFRpbWU6IDIwMjQtMDMtMjggMTk6NDI6MzQKICogQEZpbGVQYXRoOiAvZmluYWwtcGhyYXNlLWRlbW8vc3JjL3V0aWxzL2luZGV4LnRzCiAqIEBEZXNjcmlwdGlvbjoKICovCmV4cG9ydCBjb25zdCB0ZXh0SGFuZGxlID0gaHRtbFN0cmluZyA9PiB7CiAgLy8g5L2/55So5q2j5YiZ6KGo6L6+5byP5Y676Zmk5pyA5aSW5bGCIDxkaXY+IOagh+etvgogIGNvbnN0IHJlZ2V4ID0gLzxkaXZbXj5dKj4oLio/KTxcL2Rpdj4vOwogIGNvbnN0IG1hdGNoID0gaHRtbFN0cmluZy5tYXRjaChyZWdleCk7CiAgaWYgKG1hdGNoICYmIG1hdGNoLmxlbmd0aCA+PSAyKSB7CiAgICBodG1sU3RyaW5nID0gbWF0Y2hbMV07CiAgfQogIHJldHVybiBodG1sU3RyaW5nOwp9OwpleHBvcnQgZnVuY3Rpb24gQ2hPcmRlcihudW1iZXIpIHsKICBudW1iZXIgPSBwYXJzZUludChudW1iZXIudG9TdHJpbmcoKSwgMTApOwogIGNvbnN0IHV0aWwgPSBbJ+S4qicsICfljYEnLCAn55m+JywgJ+WNgyddOwogIGNvbnN0IGNpbmRleCA9IFsn6Zu2JywgJ+S4gCcsICfkuownLCAn5LiJJywgJ+WbmycsICfkupQnLCAn5YWtJywgJ+S4gycsICflhasnLCAn5LmdJ107CiAgY29uc3QgbnVtQXJyID0gbnVtYmVyLnRvU3RyaW5nKCkucmVwbGFjZSgvXjAqLywgJycpLnNwbGl0KCcnKS5yZXZlcnNlKCk7CiAgaWYgKG51bUFyci5sZW5ndGggPiAzKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfSBlbHNlIHsKICAgIGNvbnN0IHJOdW0gPSBudW1BcnIubWFwKChudW0sIGluZGV4KSA9PiB7CiAgICAgIGNvbnN0IGFkZHIgPSB1dGlsW2luZGV4XTsKICAgICAgY29uc3QgY29yID0gY2luZGV4W3BhcnNlSW50KG51bSldOwogICAgICBpZiAobnVtID09PSAnMCcpIHsKICAgICAgICByZXR1cm4gJ+mbtic7CiAgICAgIH0KICAgICAgaWYgKGluZGV4ID09PSAwKSB7CiAgICAgICAgcmV0dXJuIGNvcjsKICAgICAgfQogICAgICBpZiAobnVtQXJyLmxlbmd0aCA9PT0gMiAmJiBudW1BcnJbMV0gPT09ICcxJykgewogICAgICAgIHJldHVybiBhZGRyOwogICAgICB9CiAgICAgIHJldHVybiBjb3IgKyBhZGRyOwogICAgfSk7CiAgICBjb25zdCByZXMgPSByTnVtLnJldmVyc2UoKS5qb2luKCcnKS5yZXBsYWNlKC/pm7Z7MSx9L2csICfpm7YnKS5yZXBsYWNlKC/pm7Z7MSx9JC9nLCAnJyk7CiAgICByZXR1cm4gcmVzOwogIH0KfQpleHBvcnQgZnVuY3Rpb24gZG93bkxvYWRXb3JkRG9jKGRvbSwgbmFtZSA9ICfliafmnKwnKSB7CiAgLy/miqXlkYrlr7zlh7p3b3JkCiAgY29uc3QgaHRtbERvY3ggPSByZXF1aXJlKCdodG1sLWRvY3gtanMtdHlwZXNjcmlwdCcpOwogIGNvbnN0IHsKICAgIHNhdmVBcwogIH0gPSByZXF1aXJlKCdmaWxlLXNhdmVyJyk7CiAgdHJ5IHsKICAgIGNvbnN0IGNvbnZlcnRlZEZpbGUgPSBodG1sRG9jeC5hc0Jsb2IoZG9tKTsKICAgIC8vIOeUn+aIkOmTvuaOpeW5tuS4lOS4i+i9vQogICAgLy8gY29uc3QgZmlsZURhdGEgPSBjb252ZXJ0ZWRGaWxlCiAgICAvL0B0cy1pZ25vcmUKICAgIGNvbnZlcnRlZEZpbGUudGhlbihmaWxlRGF0YSA9PiB7CiAgICAgIHNhdmVBcyhmaWxlRGF0YSwgbmFtZSArICcuZG9jeCcsIHsKICAgICAgICBlbmNvZGluZzogJ1VURi04JwogICAgICB9KTsKICAgIH0pOwogICAgcmV0dXJuIHRydWU7CiAgfSBjYXRjaCAoZXJyb3IpIHsKICAgIGNvbnNvbGUubG9nKGVycm9yKTsKICAgIHJldHVybiBmYWxzZTsKICB9Cn0="},{"version":3,"names":["textHandle","htmlString","regex","match","length","ChOrder","number","parseInt","toString","util","cindex","numArr","replace","split","reverse","rNum","map","num","index","addr","cor","res","join","downLoadWordDoc","dom","name","htmlDocx","require","saveAs","convertedFile","asBlob","then","fileData","encoding","error","console","log"],"sources":["/Users/bytedance/code/final-phrase-demo/node_modules/eslint-loader/index.js??ref--14-0!/Users/bytedance/code/final-phrase-demo/src/utils/index.ts"],"sourcesContent":["/*\n * @Author: 777\n * @Date: 2024-03-25 21:08:30\n * @LastEditors: 777\n * @LastEditTime: 2024-03-28 19:42:34\n * @FilePath: /final-phrase-demo/src/utils/index.ts\n * @Description:\n */\nexport const textHandle = (htmlString: string) => {\n    // 使用正则表达式去除最外层 <div> 标签\n    const regex = /<div[^>]*>(.*?)<\\/div>/;\n    const match = htmlString.match(regex);\n    if (match && match.length >= 2) {\n        htmlString = match[1];\n    }\n    return htmlString;\n};\n\nexport function ChOrder(number: number): string | false {\n    number = parseInt(number.toString(), 10);\n    const util: string[] = ['个', '十', '百', '千'];\n    const cindex: string[] = [\n        '零',\n        '一',\n        '二',\n        '三',\n        '四',\n        '五',\n        '六',\n        '七',\n        '八',\n        '九'\n    ];\n    const numArr: string[] = number\n        .toString()\n        .replace(/^0*/, '')\n        .split('')\n        .reverse();\n    if (numArr.length > 3) {\n        return false;\n    } else {\n        const rNum: string[] = numArr.map((num, index) => {\n            const addr: string = util[index];\n            const cor: string = cindex[parseInt(num)];\n            if (num === '0') {\n                return '零';\n            }\n            if (index === 0) {\n                return cor;\n            }\n\n            if (numArr.length === 2 && numArr[1] === '1') {\n                return addr;\n            }\n            return cor + addr;\n        });\n        const res: string = rNum\n            .reverse()\n            .join('')\n            .replace(/零{1,}/g, '零')\n            .replace(/零{1,}$/g, '');\n        return res;\n    }\n}\n\nexport function downLoadWordDoc(dom: any, name: string = '剧本') {\n    //报告导出word\n    const htmlDocx = require('html-docx-js-typescript');\n    const { saveAs } = require('file-saver');\n    try {\n        const convertedFile = htmlDocx.asBlob(dom);\n\n        // 生成链接并且下载\n        // const fileData = convertedFile\n        //@ts-ignore\n        convertedFile.then(fileData => {\n            saveAs(fileData as Blob, name + '.docx', {\n                encoding: 'UTF-8'\n            });\n        });\n        return true\n    } catch (error) {\n        console.log(error);\n        return false\n    }\n}\n"],"mappings":"AAAA;;;;;;;;AAQA,OAAO,MAAMA,UAAU,GAAIC,UAAkB,IAAI;EAC7C;EACA,MAAMC,KAAK,GAAG,wBAAwB;EACtC,MAAMC,KAAK,GAAGF,UAAU,CAACE,KAAK,CAACD,KAAK,CAAC;EACrC,IAAIC,KAAK,IAAIA,KAAK,CAACC,MAAM,IAAI,CAAC,EAAE;IAC5BH,UAAU,GAAGE,KAAK,CAAC,CAAC,CAAC;;EAEzB,OAAOF,UAAU;AACrB,CAAC;AAED,OAAM,SAAUI,OAAOA,CAACC,MAAc;EAClCA,MAAM,GAAGC,QAAQ,CAACD,MAAM,CAACE,QAAQ,EAAE,EAAE,EAAE,CAAC;EACxC,MAAMC,IAAI,GAAa,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;EAC3C,MAAMC,MAAM,GAAa,CACrB,GAAG,EACH,GAAG,EACH,GAAG,EACH,GAAG,EACH,GAAG,EACH,GAAG,EACH,GAAG,EACH,GAAG,EACH,GAAG,EACH,GAAG,CACN;EACD,MAAMC,MAAM,GAAaL,MAAM,CAC1BE,QAAQ,EAAE,CACVI,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,CAClBC,KAAK,CAAC,EAAE,CAAC,CACTC,OAAO,EAAE;EACd,IAAIH,MAAM,CAACP,MAAM,GAAG,CAAC,EAAE;IACnB,OAAO,KAAK;GACf,MAAM;IACH,MAAMW,IAAI,GAAaJ,MAAM,CAACK,GAAG,CAAC,CAACC,GAAG,EAAEC,KAAK,KAAI;MAC7C,MAAMC,IAAI,GAAWV,IAAI,CAACS,KAAK,CAAC;MAChC,MAAME,GAAG,GAAWV,MAAM,CAACH,QAAQ,CAACU,GAAG,CAAC,CAAC;MACzC,IAAIA,GAAG,KAAK,GAAG,EAAE;QACb,OAAO,GAAG;;MAEd,IAAIC,KAAK,KAAK,CAAC,EAAE;QACb,OAAOE,GAAG;;MAGd,IAAIT,MAAM,CAACP,MAAM,KAAK,CAAC,IAAIO,MAAM,CAAC,CAAC,CAAC,KAAK,GAAG,EAAE;QAC1C,OAAOQ,IAAI;;MAEf,OAAOC,GAAG,GAAGD,IAAI;IACrB,CAAC,CAAC;IACF,MAAME,GAAG,GAAWN,IAAI,CACnBD,OAAO,EAAE,CACTQ,IAAI,CAAC,EAAE,CAAC,CACRV,OAAO,CAAC,QAAQ,EAAE,GAAG,CAAC,CACtBA,OAAO,CAAC,SAAS,EAAE,EAAE,CAAC;IAC3B,OAAOS,GAAG;;AAElB;AAEA,OAAM,SAAUE,eAAeA,CAACC,GAAQ,EAAEC,IAAA,GAAe,IAAI;EACzD;EACA,MAAMC,QAAQ,GAAGC,OAAO,CAAC,yBAAyB,CAAC;EACnD,MAAM;IAAEC;EAAM,CAAE,GAAGD,OAAO,CAAC,YAAY,CAAC;EACxC,IAAI;IACA,MAAME,aAAa,GAAGH,QAAQ,CAACI,MAAM,CAACN,GAAG,CAAC;IAE1C;IACA;IACA;IACAK,aAAa,CAACE,IAAI,CAACC,QAAQ,IAAG;MAC1BJ,MAAM,CAACI,QAAgB,EAAEP,IAAI,GAAG,OAAO,EAAE;QACrCQ,QAAQ,EAAE;OACb,CAAC;IACN,CAAC,CAAC;IACF,OAAO,IAAI;GACd,CAAC,OAAOC,KAAK,EAAE;IACZC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC;IAClB,OAAO,KAAK;;AAEpB","ignoreList":[]}]}