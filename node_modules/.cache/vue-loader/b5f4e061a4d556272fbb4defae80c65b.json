{"remainingRequest":"/Users/bytedance/code/final-phrase-demo/node_modules/vue-loader-v16/dist/index.js??ref--1-1!/Users/bytedance/code/final-phrase-demo/src/components/RichText/index.vue?vue&type=style&index=1&id=8e3690c8&lang=less","dependencies":[{"path":"/Users/bytedance/code/final-phrase-demo/src/components/RichText/index.vue","mtime":1720003919952},{"path":"/Users/bytedance/code/final-phrase-demo/node_modules/css-loader/dist/cjs.js","mtime":1720003916407},{"path":"/Users/bytedance/code/final-phrase-demo/node_modules/vue-loader-v16/dist/stylePostLoader.js","mtime":1720003919761},{"path":"/Users/bytedance/code/final-phrase-demo/node_modules/postcss-loader/src/index.js","mtime":1720003918676},{"path":"/Users/bytedance/code/final-phrase-demo/node_modules/less-loader/dist/cjs.js","mtime":1720003918196},{"path":"/Users/bytedance/code/final-phrase-demo/node_modules/cache-loader/dist/cjs.js","mtime":1720003915936},{"path":"/Users/bytedance/code/final-phrase-demo/node_modules/vue-loader-v16/dist/index.js","mtime":1720003919760}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5yaWNoLXRleHQgewogICAgd2lkdGg6IDEwMCU7CiAgICBoZWlnaHQ6IGNhbGMoMTAwJSAtIDEwMnB4KTsKfQo="},{"version":3,"sources":["/Users/bytedance/code/final-phrase-demo/src/components/RichText/index.vue"],"names":[],"mappings":";AAkYA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;IACP,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IACX,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AAC9B","file":"/Users/bytedance/code/final-phrase-demo/src/components/RichText/index.vue","sourceRoot":"","sourcesContent":["<!--\n * @Author: 777\n * @Date: 2024-03-24 14:20:27\n * @LastEditors: suqi04\n * @LastEditTime: 2024-04-28 10:32:47\n * @FilePath: /final-phrase-demo/src/components/RichText/index.vue\n * @Description:\n-->\n<!--  -->\n<template>\n    <div class=\"rich-text\">\n        <quill-editor\n            ref=\"myQuillEditor\"\n            content-type=\"html\"\n            :content=\"state.text\"\n            :options=\"editorOption\"\n            @text-change=\"change\"\n            @selection-change=\"selection\"\n            @mouseup=\"mouseup\"\n            @click=\"showReloadBtn = false\"\n            @contextmenu.prevent=\"rightClick\"\n        />\n        <div\n            v-show=\"showReloadBtn\"\n            class=\"reload-text\"\n            :style=\"{\n                top: `${mouseTopAndLeft.y}px`,\n                left: `${mouseTopAndLeft.x}px`\n            }\"\n            @contextmenu.prevent\n            @click.stop\n        >\n            <div class=\"reload-text-content\">\n                <div\n                    class=\"reload-text-content-line\"\n                    @click=\"reloadSelectText('oldRange')\"\n                >\n                    <span>重新生成选中区域</span>\n                </div>\n                <div\n                    class=\"reload-text-content-line\"\n                    @click=\"expansionSelectText('oldRange')\"\n                >\n                    <span>扩写选中区域</span>\n                </div>\n                <div\n                    class=\"reload-text-content-line\"\n                    @click=\"continuationSelectText('oldRange')\"\n                >\n                    <span>续写选中区域</span>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport {\n    reactive,\n    toRefs,\n    onMounted,\n    ref,\n    defineProps,\n    defineEmits,\n    toRaw,\n    watch\n} from 'vue';\nimport { ElLoading } from 'element-plus';\nimport { QuillEditor, Quill } from '@vueup/vue-quill';\nimport { downLoadWordDoc } from '@/utils';\nimport { useRouter } from 'vue-router';\nimport PlayInfo from '@/store/palyInfo';\nimport { ElMessage } from 'element-plus';\nconst { nowTitle } = PlayInfo();\n\nconst router = useRouter();\n//@ts-ignore\n// import * as  from 'quill';\nconst props = defineProps({\n    content: {\n        type: String,\n        default: ''\n    }\n});\n\nconst mouseTopAndLeft = reactive({\n    x: 0,\n    y: 0\n});\n\nconst state = reactive({\n    text: props.content\n});\nvar Bold = Quill.import('formats/bold');\nBold.tagName = 'B'; // Quill uses <strong> by default\nQuill.register(Bold, true);\n\nconst emit = defineEmits(['saveRich']);\nconst downSvg =\n    '<svg t=\"1711624986970\" class=\"icon\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" p-id=\"2888\"><path d=\"M811.323077 590.769231v220.553846H212.676923v-220.553846H118.153846v315.076923h787.692308v-315.076923z\" fill=\"#333333\" p-id=\"2889\"></path><path d=\"M512 712.861538l118.153846-122.092307h-70.892308V118.153846h-94.523076v472.615385h-70.892308z\" fill=\"#333333\" p-id=\"2890\"></path></svg>';\nconst saveSvg =\n    '<svg t=\"1711618157084\" class=\"icon\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" p-id=\"1732\"><path d=\"M338.1 341.4h229.1c20.7 0 37.7-17 37.7-37.7V129.5c0-20.7-17-37.7-37.7-37.7H338.1c-20.7 0-37.7 17-37.7 37.7v174.1c0 20.8 17 37.8 37.7 37.8z\" fill=\"#6D6E70\" p-id=\"1733\"></path><path d=\"M772 68.2h-82.5v292.1c0 12.3-10 22.3-22.3 22.3H232.4c-12.3 0-22.3-10-22.3-22.4l1.8-292h-69.2c-33.4 0-60.5 27.1-60.5 60.5V892c0 33.4 27.1 60.5 60.5 60.5h737.7c33.4 0 60.5-27.1 60.5-60.5V258.8L772 68.2z m57 765.5c0 17.7-14.5 32.3-32.3 32.3H240.3c-17.7 0-32.3-14.5-32.3-32.3V501.4c0-17.7 14.5-32.3 32.3-32.3h556.4c17.7 0 32.3 14.5 32.3 32.3v332.3z\" fill=\"#6D6E70\" p-id=\"1734\"></path><path d=\"M723.7 585.7H302.5c-16 0-29.1 13.1-29.1 29.1s13.1 29.1 29.1 29.1h421.2c16 0 29.1-13.1 29.1-29.1s-13.1-29.1-29.1-29.1zM723.7 737H302.5c-16 0-29.1 13.1-29.1 29.1s13.1 29.1 29.1 29.1h421.2c16 0 29.1-13.1 29.1-29.1S739.7 737 723.7 737z\" fill=\"#6D6E70\" p-id=\"1735\"></path></svg>';\nconst reloadTextSvg =\n    '<svg t=\"1713667293366\" class=\"icon\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" p-id=\"1542\"><path d=\"M337.62183964 696.72936427h-34.23732268c-16.86315859 0-30.66029086 13.66938006-30.66029089 30.66028739 0 16.86315859 13.66938006 30.66029086 30.66029089 30.66029094h34.23732268c16.86315859 0 30.66029086-13.66938006 30.66029086-30.66029094s-13.79712884-30.66029086-30.66029086-30.66028739z m195.45934399-165.69331534H294.56968433c-12.00861458 0-21.84545481 13.66938006-21.84545826 30.66028748 0 16.86315859 9.70909146 30.66029086 21.84545826 30.66029087h238.5114993c12.00861458 0 21.84545481-13.66938006 21.84545826-30.66029087s-9.70909146-30.66029086-21.84545826-30.66028748z m104.88374263-159.56125923H303.38451696c-16.86315859 0-30.66029086 13.66938006-30.66029089 30.66029088 0 16.86315859 13.66938006 30.66029086 30.66029089 30.66029082H637.96492626c16.86315859 0 30.66029086-13.66938006 30.66028743-30.66029082s-13.66938006-30.66029086-30.66028743-30.66029088z\" p-id=\"1543\"></path><path d=\"M518.00654269 918.50545721H160.04766196c-4.98229623 0-8.94258482-4.0880374-8.94258481-8.94258481v-707.99718428c0-4.85454745 3.9602886-8.94258482 8.94258481-8.9425848h29.25502648c0.38325328 0 0.76650659 0.38325328 0.76650662 0.76650659v14.05263333c0 35.77033932 29.25502647 65.02536243 65.02536581 65.02536236H683.95535911c35.38708263 0 64.25885581-28.74402095 64.25885924-64.2588558v-14.81913989c0-0.38325328 0.38325328-0.76650659 0.76650657-0.76650659h29.2550265c4.85454745 0 8.94258482 4.0880374 8.94258485 8.9425848v290.5062429c0 16.86315859 13.66938006 30.53253866 30.53253866 30.53253865s30.53253866-13.66938006 30.53253514-30.53253865v-291.27275292c0.12775226-38.32536356-30.91579188-69.36890432-69.11339983-69.36890426h-30.14928532c-0.38325328 0-0.76650659-0.38325328-0.76650657-0.76650663-1.02201109-34.49282721-29.38277873-62.21483715-64.13110703-62.21483712h-54.5497644c-0.38325328 0-0.76650659-0.38325328-0.7665066-0.76650656 0-35.77033932-29.25502647-65.02536243-65.02536584-65.02536585H376.84145867c-35.13158157 0-63.87560247 28.36076769-64.25885584 63.49234927 0 0.38325328-0.38325328 0.76650659-0.76650662 0.76650661l-57.61579416 1.53301653c-34.74832825 0-63.2368482 27.72201333-64.25885578 62.21483712 0 0.38325328-0.38325328 0.76650659-0.76651004 0.76650663h-30.14928193c-38.19761133 0-69.36890432 31.04354414-69.36890773 69.36890426v708.7636943c0 38.58086462 31.55454971 70.13541089 70.13541432 70.13541092h358.2143818c16.86315859 0 30.53253866-13.66938006 30.53253861-30.5325352v-0.12775222c0-16.86315859-13.66938006-30.53253866-30.53253861-30.53253869z m-266.7445182-785.92542348h0.12775225c0-1.66076539 1.40526435-2.93827751 3.06602638-2.93827752h88.91483937c16.86315859 0 30.66029086-13.66938006 30.66029088-30.66028749v-32.06555516c0-1.66076539 1.40526435-2.93827751 2.93827753-2.93827757H563.86922675c2.0440187 0 3.70478412 1.66076539 3.70478407 3.70478754v31.29904519c0 16.86315859 13.66938006 30.66029086 30.66029089 30.66028749h85.08230303c2.0440187 0 3.70478412 1.66076539 3.70478414 3.70478748v74.86220611c0 1.66076539-1.40526435 2.93827751-2.93827756 2.9382775H254.32805429c-1.66076539 0-3.06602977-1.40526435-3.0660298-2.9382775v-75.62871607z\" p-id=\"1544\"></path><path d=\"M896.02236402 850.03081176c-19.80143615 59.02105856-73.96794726 101.56220832-138.86556423 104.50048585-87.38182623 3.9602886-161.34977349-66.30287456-161.60527451-153.68470071-0.25550102-85.33780747 69.11340327-154.83446063 154.32345848-154.8344641 49.43971594 0 95.04689899 23.25071917 124.04642096 62.59809047h-18.90718071c-13.03062227 0-24.14497805 10.09234471-24.65598021 23.12297039-0.51100549 13.66938006 10.47559799 25.03923685 24.01722583 25.0392368h73.84019842c13.28612673 0 24.14497805-10.73110247 24.14497804-24.14497803v-73.20144064c0-13.03062227-10.09234471-24.14497805-23.12297044-24.65598354-13.66938006-0.51100549-25.03923685 10.47559799-25.03923681 24.0172258v10.475598c-38.19761133-44.96842521-94.79139451-71.41292298-154.32345508-71.41292302-112.42106304 0-203.76317441 92.10862135-202.48566233 204.78518208 1.27751206 111.91005755 91.98086917 200.95264918 203.89092326 200.18614254 89.42584487-0.51100549 165.31006202-58.8933063 191.49905882-140.2708252 4.72679517-14.94689214-6.51531281-30.14928533-22.22870819-30.1492853-11.24210461 0.12775226-21.07894823 7.15406719-24.5282313 17.62966861z\" p-id=\"1545\"></path></svg>';\nconst expansionTextSvg =\n    '<svg t=\"1713667293366\" class=\"icon\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" p-id=\"1542\"><path d=\"M337.62183964 696.72936427h-34.23732268c-16.86315859 0-30.66029086 13.66938006-30.66029089 30.66028739 0 16.86315859 13.66938006 30.66029086 30.66029089 30.66029094h34.23732268c16.86315859 0 30.66029086-13.66938006 30.66029086-30.66029094s-13.79712884-30.66029086-30.66029086-30.66028739z m195.45934399-165.69331534H294.56968433c-12.00861458 0-21.84545481 13.66938006-21.84545826 30.66028748 0 16.86315859 9.70909146 30.66029086 21.84545826 30.66029087h238.5114993c12.00861458 0 21.84545481-13.66938006 21.84545826-30.66029087s-9.70909146-30.66029086-21.84545826-30.66028748z m104.88374263-159.56125923H303.38451696c-16.86315859 0-30.66029086 13.66938006-30.66029089 30.66029088 0 16.86315859 13.66938006 30.66029086 30.66029089 30.66029082H637.96492626c16.86315859 0 30.66029086-13.66938006 30.66028743-30.66029082s-13.66938006-30.66029086-30.66028743-30.66029088z\" p-id=\"1543\"></path><path d=\"M518.00654269 918.50545721H160.04766196c-4.98229623 0-8.94258482-4.0880374-8.94258481-8.94258481v-707.99718428c0-4.85454745 3.9602886-8.94258482 8.94258481-8.9425848h29.25502648c0.38325328 0 0.76650659 0.38325328 0.76650662 0.76650659v14.05263333c0 35.77033932 29.25502647 65.02536243 65.02536581 65.02536236H683.95535911c35.38708263 0 64.25885581-28.74402095 64.25885924-64.2588558v-14.81913989c0-0.38325328 0.38325328-0.76650659 0.76650657-0.76650659h29.2550265c4.85454745 0 8.94258482 4.0880374 8.94258485 8.9425848v290.5062429c0 16.86315859 13.66938006 30.53253866 30.53253866 30.53253865s30.53253866-13.66938006 30.53253514-30.53253865v-291.27275292c0.12775226-38.32536356-30.91579188-69.36890432-69.11339983-69.36890426h-30.14928532c-0.38325328 0-0.76650659-0.38325328-0.76650657-0.76650663-1.02201109-34.49282721-29.38277873-62.21483715-64.13110703-62.21483712h-54.5497644c-0.38325328 0-0.76650659-0.38325328-0.7665066-0.76650656 0-35.77033932-29.25502647-65.02536243-65.02536584-65.02536585H376.84145867c-35.13158157 0-63.87560247 28.36076769-64.25885584 63.49234927 0 0.38325328-0.38325328 0.76650659-0.76650662 0.76650661l-57.61579416 1.53301653c-34.74832825 0-63.2368482 27.72201333-64.25885578 62.21483712 0 0.38325328-0.38325328 0.76650659-0.76651004 0.76650663h-30.14928193c-38.19761133 0-69.36890432 31.04354414-69.36890773 69.36890426v708.7636943c0 38.58086462 31.55454971 70.13541089 70.13541432 70.13541092h358.2143818c16.86315859 0 30.53253866-13.66938006 30.53253861-30.5325352v-0.12775222c0-16.86315859-13.66938006-30.53253866-30.53253861-30.53253869z m-266.7445182-785.92542348h0.12775225c0-1.66076539 1.40526435-2.93827751 3.06602638-2.93827752h88.91483937c16.86315859 0 30.66029086-13.66938006 30.66029088-30.66028749v-32.06555516c0-1.66076539 1.40526435-2.93827751 2.93827753-2.93827757H563.86922675c2.0440187 0 3.70478412 1.66076539 3.70478407 3.70478754v31.29904519c0 16.86315859 13.66938006 30.66029086 30.66029089 30.66028749h85.08230303c2.0440187 0 3.70478412 1.66076539 3.70478414 3.70478748v74.86220611c0 1.66076539-1.40526435 2.93827751-2.93827756 2.9382775H254.32805429c-1.66076539 0-3.06602977-1.40526435-3.0660298-2.9382775v-75.62871607z\" p-id=\"1544\"></path><path d=\"M699.2 753.6l3.2 3.2 1.6 1.6 1.6 1.6 3.2 3.2c3.2 3.2 4.8 6.4 4.8 9.6 0 3.2-3.2 4.8-6.4 9.6l-8 8-11.2 11.2c-4.8 4.8-8 8-12.8 11.2l-9.6 9.6c-3.2 3.2-4.8 6.4-6.4 8s0 4.8 1.6 6.4l6.4 6.4 6.4 6.4c3.2 3.2 4.8 4.8 3.2 8 0 1.6-3.2 3.2-8 3.2s-9.6 1.6-16 1.6-11.2 1.6-17.6 1.6c-6.4 0-11.2 1.6-17.6 1.6-6.4 0-11.2 1.6-16 1.6-4.8 0-8 0-9.6-1.6v-9.6c0-4.8 1.6-9.6 1.6-14.4 0-4.8 1.6-11.2 1.6-16 0-4.8 1.6-11.2 1.6-16 0-4.8 1.6-11.2 1.6-14.4 0-4.8 1.6-8 4.8-9.6 1.6-1.6 4.8 0 8 1.6 1.6 1.6 4.8 3.2 6.4 6.4l6.4 6.4c1.6 1.6 3.2 3.2 4.8 1.6 1.6 0 3.2-1.6 6.4-4.8l9.6-9.6 12.8-12.8 12.8-12.8c4.8-3.2 8-6.4 9.6-9.6l3.2-3.2c1.6-1.6 3.2-1.6 4.8-1.6h4.8c1.6 0 4.8 4.8 6.4 6.4z m134.4-128c4.8 0 8 0 9.6 1.6 1.6 1.6 3.2 4.8 1.6 8 0 4.8-1.6 9.6-1.6 14.4 0 4.8-1.6 11.2-1.6 16 0 4.8-1.6 11.2-1.6 16 0 4.8-1.6 11.2-1.6 14.4 0 4.8-1.6 8-4.8 9.6-1.6 1.6-4.8 0-8-3.2-1.6-1.6-4.8-3.2-8-6.4s-4.8-4.8-8-6.4c-1.6-1.6-3.2-3.2-4.8-3.2-1.6 0-3.2 1.6-4.8 3.2-3.2 1.6-6.4 4.8-9.6 9.6s-8 8-12.8 12.8l-12.8 12.8-9.6 11.2-3.2 3.2c-1.6 1.6-3.2 1.6-4.8 1.6h-4.8c-1.6 0-3.2-1.6-4.8-3.2l-9.6-9.6c-3.2-3.2-4.8-6.4-4.8-9.6s3.2-6.4 6.4-9.6l8-8 11.2-11.2c4.8-4.8 8-8 12.8-11.2l9.6-9.6c3.2-3.2 4.8-4.8 6.4-8 0-1.6 0-4.8-1.6-6.4-1.6-1.6-3.2-3.2-6.4-4.8l-6.4-6.4c-3.2-3.2-4.8-4.8-3.2-8s3.2-3.2 8-4.8 9.6-1.6 16-1.6 11.2-1.6 17.6-1.6c6.4 0 11.2-1.6 17.6-1.6 4.8 1.6 9.6 0 14.4 0z\" fill=\"none\" stroke=\"#4b5563\" stroke-width=\"50\" p-id=\"918\"></path></svg>';\nconst continuationTextSvg =\n    '<svg t=\"1713667293366\" class=\"icon\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" p-id=\"1542\"><path d=\"M337.62183964 696.72936427h-34.23732268c-16.86315859 0-30.66029086 13.66938006-30.66029089 30.66028739 0 16.86315859 13.66938006 30.66029086 30.66029089 30.66029094h34.23732268c16.86315859 0 30.66029086-13.66938006 30.66029086-30.66029094s-13.79712884-30.66029086-30.66029086-30.66028739z m195.45934399-165.69331534H294.56968433c-12.00861458 0-21.84545481 13.66938006-21.84545826 30.66028748 0 16.86315859 9.70909146 30.66029086 21.84545826 30.66029087h238.5114993c12.00861458 0 21.84545481-13.66938006 21.84545826-30.66029087s-9.70909146-30.66029086-21.84545826-30.66028748z m104.88374263-159.56125923H303.38451696c-16.86315859 0-30.66029086 13.66938006-30.66029089 30.66029088 0 16.86315859 13.66938006 30.66029086 30.66029089 30.66029082H637.96492626c16.86315859 0 30.66029086-13.66938006 30.66028743-30.66029082s-13.66938006-30.66029086-30.66028743-30.66029088z\" p-id=\"1543\"></path><path d=\"M518.00654269 918.50545721H160.04766196c-4.98229623 0-8.94258482-4.0880374-8.94258481-8.94258481v-707.99718428c0-4.85454745 3.9602886-8.94258482 8.94258481-8.9425848h29.25502648c0.38325328 0 0.76650659 0.38325328 0.76650662 0.76650659v14.05263333c0 35.77033932 29.25502647 65.02536243 65.02536581 65.02536236H683.95535911c35.38708263 0 64.25885581-28.74402095 64.25885924-64.2588558v-14.81913989c0-0.38325328 0.38325328-0.76650659 0.76650657-0.76650659h29.2550265c4.85454745 0 8.94258482 4.0880374 8.94258485 8.9425848v290.5062429c0 16.86315859 13.66938006 30.53253866 30.53253866 30.53253865s30.53253866-13.66938006 30.53253514-30.53253865v-291.27275292c0.12775226-38.32536356-30.91579188-69.36890432-69.11339983-69.36890426h-30.14928532c-0.38325328 0-0.76650659-0.38325328-0.76650657-0.76650663-1.02201109-34.49282721-29.38277873-62.21483715-64.13110703-62.21483712h-54.5497644c-0.38325328 0-0.76650659-0.38325328-0.7665066-0.76650656 0-35.77033932-29.25502647-65.02536243-65.02536584-65.02536585H376.84145867c-35.13158157 0-63.87560247 28.36076769-64.25885584 63.49234927 0 0.38325328-0.38325328 0.76650659-0.76650662 0.76650661l-57.61579416 1.53301653c-34.74832825 0-63.2368482 27.72201333-64.25885578 62.21483712 0 0.38325328-0.38325328 0.76650659-0.76651004 0.76650663h-30.14928193c-38.19761133 0-69.36890432 31.04354414-69.36890773 69.36890426v708.7636943c0 38.58086462 31.55454971 70.13541089 70.13541432 70.13541092h358.2143818c16.86315859 0 30.53253866-13.66938006 30.53253861-30.5325352v-0.12775222c0-16.86315859-13.66938006-30.53253866-30.53253861-30.53253869z m-266.7445182-785.92542348h0.12775225c0-1.66076539 1.40526435-2.93827751 3.06602638-2.93827752h88.91483937c16.86315859 0 30.66029086-13.66938006 30.66029088-30.66028749v-32.06555516c0-1.66076539 1.40526435-2.93827751 2.93827753-2.93827757H563.86922675c2.0440187 0 3.70478412 1.66076539 3.70478407 3.70478754v31.29904519c0 16.86315859 13.66938006 30.66029086 30.66029089 30.66028749h85.08230303c2.0440187 0 3.70478412 1.66076539 3.70478414 3.70478748v74.86220611c0 1.66076539-1.40526435 2.93827751-2.93827756 2.9382775H254.32805429c-1.66076539 0-3.06602977-1.40526435-3.0660298-2.9382775v-75.62871607z\" p-id=\"1544\"></path><path d=\"M656 784c17.6 0 32-14.4 32-32s-14.4-32-32-32-32 14.4-32 32 14.4 32 32 32z m112 0c17.6 0 32-14.4 32-32s-14.4-32-32-32-32 14.4-32 32 14.4 32 32 32z m112 0c17.6 0 32-14.4 32-32s-14.4-32-32-32-32 14.4-32 32 14.4 32 32 32z\" fill=\"none\" stroke=\"#4b5563\" stroke-width=\"50\" p-id=\"1093\"></path></svg>';\nconst myQuillEditor = ref();\nconst showReloadBtn = ref(false);\nconst selected = ref(false);\nwatch(\n    selected,\n    val => {\n        const quillReloadTexttnDom = document.querySelector(\n            '.ql-finalPhraseReload'\n        );\n        const quillExpansionDom = document.querySelector(\n            '.ql-finalPhraseExpansion'\n        );\n        const quillContinuationDom = document.querySelector(\n            '.ql-finalPhraseContinuation'\n        );\n        if (quillReloadTexttnDom) {\n            if (val) {\n                quillReloadTexttnDom.style.cursor = 'pointer';\n            } else {\n                quillReloadTexttnDom.style.cursor = 'not-allowed';\n            }\n        }\n        if (quillExpansionDom) {\n            if (val) {\n                quillExpansionDom.style.cursor = 'pointer';\n            } else {\n                quillExpansionDom.style.cursor = 'not-allowed';\n            }\n        }\n        if (quillContinuationDom) {\n            if (val) {\n                quillContinuationDom.style.cursor = 'pointer';\n            } else {\n                quillContinuationDom.style.cursor = 'not-allowed';\n            }\n        }\n    },\n    { deep: true }\n);\nlet editorOption = {\n    modules: {\n        toolbar: {\n            container: [\n                ['finalPhraseSave'],\n                [\n                    'bold',\n                    'italic',\n                    'underline',\n                    'strike',\n                    { color: [] },\n                    { background: [] } // 字体颜色、字体背景颜色\n                ], // 加粗 斜体 下划线 删除线\n                // [{ align: [] }], // 对齐方式\n                [{ header: [1, 2, 3, 4, 5, 6, false] }], // 标题\n                // [{ direction: 'ltl' }], // 文本方向\n                // [{ direction: 'rtl' }], // 文本方向\n                // [{ indent: '-1' }, { indent: '+1' }], // 缩进\n                // [{ list: 'ordered' }, { list: 'bullet' }], // 有序、无序列表\n                // [{ script: 'sub' }, { script: 'super' }], // 上标/下标\n                // ['blockquote', 'code-block'], // 引用  代码块\n                ['clean'], // 清除文本格式\n                [\n                    'finalPhraseReload',\n                    'finalPhraseExpansion',\n                    'finalPhraseContinuation'\n                ]\n                // ['link', 'image', 'video'] // 链接、图片、视频\n            ],\n            handlers: {\n                shadeBox: null,\n                that: this,\n                finalPhraseSave: function () {\n                    const htmlDom = `<h2>${nowTitle.value}</h2>${toRaw(\n                        myQuillEditor.value\n                    ).getHTML()}`;\n\n                    downLoadWordDoc(htmlDom, nowTitle.value);\n                },\n                finalPhraseReload: function () {\n                    if (selected.value) {\n                        reloadSelectText();\n                    }\n                },\n                finalPhraseExpansion: function () {\n                    if (selected.value) {\n                        expansionSelectText();\n                    }\n                },\n                finalPhraseContinuation: function () {\n                    if (selected.value) {\n                        continuationSelectText();\n                    }\n                }\n            }\n        }\n        // toolbar: false\n    }\n};\n\nfunction change(val: any) {\n    // console.log(toRaw(myQuillEditor.value).getHTML());\n    // console.log(state.text);\n    // convertClassesToStyles(document.querySelector('.ql-editor'))\n    emit('saveRich', toRaw(myQuillEditor.value).getHTML());\n}\n\nlet selectParams = reactive({\n    range: null,\n    oldRange: null,\n    source: null\n});\n\nfunction rightClick(e: any) {\n    showReloadBtn.value = true;\n    mouseTopAndLeft.x = e.x + 10;\n    mouseTopAndLeft.y = e.y + 10;\n}\n\nfunction reloadSelectText(key = 'range') {\n    const quill = toRefs(myQuillEditor.value);\n    let { range, oldRange, source } = selectParams;\n    range = selectParams[key]\n\n    showReloadBtn.value = false;\n    if (range && range.index && range.length) {\n        const loading = ElLoading.service({\n            lock: true,\n            text: '重新生成中, 请勿刷新浏览器...'\n        });\n        setTimeout(() => {\n            loading.close();\n            ElMessage.success('重写已完成');\n            quill.getQuill.value().deleteText(range.index, range.length);\n            quill.getQuill\n                .value()\n                .insertText(range.index, '我是重新生成的文本');\n        }, 3000);\n    }\n}\n\nfunction continuationSelectText(key = 'range') {\n    const quill = toRefs(myQuillEditor.value);\n    let { range, oldRange, source } = selectParams;\n    range = selectParams[key]\n\n    showReloadBtn.value = false;\n    if (range && range.index && range.length) {\n        const loading = ElLoading.service({\n            lock: true,\n            text: '文案续写中中, 请勿刷新浏览器...'\n        });\n        setTimeout(() => {\n            loading.close();\n            ElMessage.success('续写已填充至文案末尾');\n            quill.getQuill\n                .value()\n                .insertText(range.index + range.length, '我是续写的文本');\n        }, 3000);\n    }\n}\n\nfunction expansionSelectText(key = 'range') {\n    console.log(selectParams);\n    \n    const quill = toRefs(myQuillEditor.value);\n    let { range, oldRange, source } = selectParams;\n    range = selectParams[key]\n    showReloadBtn.value = false;\n    if (range && range.index && range.length) {\n        const loading = ElLoading.service({\n            lock: true,\n            text: '文案扩写中, 请勿刷新浏览器...'\n        });\n        setTimeout(() => {\n            loading.close();\n            ElMessage.success('扩写文案已填充至选中区域');\n            quill.getQuill.value().deleteText(range.index, range.length);\n            quill.getQuill\n                .value()\n                .insertText(range.index, '我是扩写(这里是扩写文案)生成的文本');\n        }, 3000);\n    }\n}\n\nfunction selection(params: any) {\n    const { range, oldRange, source } = params;\n    selectParams = params;\n    const quill = toRefs(myQuillEditor.value);\n    // console.log(quill);\n    // console.log(quill.getQuill.value());\n\n    if (range && range.index && range.length) {\n        selected.value = true;\n        var text = quill.getText.value(range.index, range.length);\n        // quill.reinit.value(range.length)\n        console.log('User has highlighted', text);\n        console.log(mouseTopAndLeft);\n    } else {\n        console.log('Cursor not in the editor');\n        selected.value = false;\n    }\n}\n\nfunction mouseup(e: any) {\n    console.log(e);\n}\n\nconst nextHandle = () => {\n    setTimeout(() => {\n        router.push({\n            path: '/showPlay',\n            query: {\n                showScript: 'read'\n            }\n        });\n    }, 100);\n};\nonMounted(() => {\n    const quillSaveBtnDom = document.querySelector('.ql-finalPhraseSave');\n    // @ts-ignore\n    quillSaveBtnDom.innerHTML = downSvg;\n    const quillReloadTexttnDom = document.querySelector(\n        '.ql-finalPhraseReload'\n    );\n    if (quillReloadTexttnDom) {\n        // @ts-ignore\n        quillReloadTexttnDom.innerHTML = reloadTextSvg;\n        quillReloadTexttnDom.style.cursor = 'not-allowed';\n    }\n    const quillExpansionDom = document.querySelector(\n        '.ql-finalPhraseExpansion'\n    );\n    if (quillExpansionDom) {\n        // @ts-ignore\n        quillExpansionDom.innerHTML = expansionTextSvg;\n        quillExpansionDom.style.cursor = 'not-allowed';\n    }\n    const quillContinuationDom = document.querySelector(\n        '.ql-finalPhraseContinuation'\n    );\n    if (quillContinuationDom) {\n        // @ts-ignore\n        quillContinuationDom.innerHTML = continuationTextSvg;\n        quillContinuationDom.style.cursor = 'not-allowed';\n    }\n});\n</script>\n<style lang=\"less\" scoped>\n.reload-text {\n    box-shadow: 0 0 3px #00000075;\n    background-color: #fffffff0;\n    border-radius: 5px;\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: auto;\n    min-width: 150px;\n    height: auto;\n    padding: 10px 5px;\n    &-content {\n        width: auto;\n        min-width: 100%;\n        &-line {\n            height: 25px;\n            font-size: 14px;\n            line-height: 25px;\n            padding: 0 5px;\n            border-radius: 5px;\n            cursor: pointer;\n        }\n        &-line:hover {\n            color: #fff;\n            background-color: #4096fe;\n        }\n    }\n}\n</style>\n<style lang=\"less\">\n.rich-text {\n    width: 100%;\n    height: calc(100% - 102px);\n}\n</style>\n<style lang=\"less\">\n.ql-editor p {\n    font-size: 14px;\n}\n.editor {\n    line-height: normal !important;\n    height: 500px !important;\n    width: 100vw;\n}\n\n.ql-container {\n    min-height: 500px !important;\n}\n\n.ql-snow .ql-tooltip[data-mode='link']::before {\n    content: '请输入链接地址:' !important;\n}\n.ql-snow .ql-tooltip.ql-editing a.ql-action::after {\n    border-right: 0px !important;\n    content: '保存' !important;\n    padding-right: 0px !important;\n}\n\n.ql-snow .ql-tooltip[data-mode='video']::before {\n    content: '请输入视频地址:' !important;\n}\n\n.ql-snow .ql-picker.ql-size .ql-picker-label::before,\n.ql-snow .ql-picker.ql-size .ql-picker-item::before {\n    content: '14px' !important;\n}\n.ql-snow .ql-picker.ql-size .ql-picker-label[data-value='small']::before,\n.ql-snow .ql-picker.ql-size .ql-picker-item[data-value='small']::before {\n    content: '10px' !important;\n}\n.ql-snow .ql-picker.ql-size .ql-picker-label[data-value='large']::before,\n.ql-snow .ql-picker.ql-size .ql-picker-item[data-value='large']::before {\n    content: '18px' !important;\n}\n.ql-snow .ql-picker.ql-size .ql-picker-label[data-value='huge']::before,\n.ql-snow .ql-picker.ql-size .ql-picker-item[data-value='huge']::before {\n    content: '32px' !important;\n}\n\n.ql-snow .ql-picker.ql-header .ql-picker-label::before,\n.ql-snow .ql-picker.ql-header .ql-picker-item::before {\n    content: '文本' !important;\n}\n.ql-snow .ql-picker.ql-header .ql-picker-label[data-value='1']::before,\n.ql-snow .ql-picker.ql-header .ql-picker-item[data-value='1']::before {\n    content: '标题1' !important;\n}\n.ql-snow .ql-picker.ql-header .ql-picker-label[data-value='2']::before,\n.ql-snow .ql-picker.ql-header .ql-picker-item[data-value='2']::before {\n    content: '标题2' !important;\n}\n.ql-snow .ql-picker.ql-header .ql-picker-label[data-value='3']::before,\n.ql-snow .ql-picker.ql-header .ql-picker-item[data-value='3']::before {\n    content: '标题3' !important;\n}\n.ql-snow .ql-picker.ql-header .ql-picker-label[data-value='4']::before,\n.ql-snow .ql-picker.ql-header .ql-picker-item[data-value='4']::before {\n    content: '标题4' !important;\n}\n.ql-snow .ql-picker.ql-header .ql-picker-label[data-value='5']::before,\n.ql-snow .ql-picker.ql-header .ql-picker-item[data-value='5']::before {\n    content: '标题5' !important;\n}\n.ql-snow .ql-picker.ql-header .ql-picker-label[data-value='6']::before,\n.ql-snow .ql-picker.ql-header .ql-picker-item[data-value='6']::before {\n    content: '标题6' !important;\n}\n\n.ql-snow .ql-picker.ql-font .ql-picker-label::before,\n.ql-snow .ql-picker.ql-font .ql-picker-item::before {\n    content: '标准字体' !important;\n}\n.ql-snow .ql-picker.ql-font .ql-picker-label[data-value='serif']::before,\n.ql-snow .ql-picker.ql-font .ql-picker-item[data-value='serif']::before {\n    content: '衬线字体' !important;\n}\n.ql-snow .ql-picker.ql-font .ql-picker-label[data-value='monospace']::before,\n.ql-snow .ql-picker.ql-font .ql-picker-item[data-value='monospace']::before {\n    content: '等宽字体' !important;\n}\n</style>\n"]}]}